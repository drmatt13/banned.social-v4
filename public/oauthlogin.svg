<?xml version="1.0" encoding="UTF-8"?>
<!-- Do not edit this file with editors other than diagrams.net -->
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="1315px" height="619px" viewBox="-0.5 -0.5 1315 619" content="&lt;mxfile host=&quot;app.diagrams.net&quot; modified=&quot;2022-08-13T04:48:31.108Z&quot; agent=&quot;5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/104.0.0.0 Safari/537.36&quot; etag=&quot;3yRxPBOqaSuEObd97FIU&quot; version=&quot;20.2.3&quot;&gt;&lt;diagram id=&quot;nyGgYAhSqX84DXuaym8C&quot; name=&quot;Page-1&quot;&gt;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&lt;/diagram&gt;&lt;/mxfile&gt;" style="background-color: rgb(255, 255, 255);"><defs/><g><rect x="0" y="0" width="1314" height="618" fill="none" stroke="none" pointer-events="all"/><path d="M 264 486 L 284.18 486" fill="none" stroke="rgb(0, 0, 0)" stroke-width="0.6" stroke-miterlimit="10" stroke-dasharray="1.7999999999999998 1.7999999999999998" pointer-events="stroke"/><path d="M 287.33 486 L 283.13 488.1 L 284.18 486 L 283.13 483.9 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-width="0.6" stroke-miterlimit="10" pointer-events="all"/><rect x="144" y="468" width="120" height="36" fill="#fff2cc" stroke="#d6b656" stroke-width="0.6" pointer-events="all"/><g transform="translate(-0.5 -0.5)scale(0.6)"><switch><foreignObject pointer-events="none" width="167%" height="167%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 198px; height: 1px; padding-top: 810px; margin-left: 241px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">/login?path=/route&amp;param1=...</div></div></div></foreignObject><text x="340" y="814" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">/login?path=/route&amp;param1=...</text></switch></g><path d="M 120 486 L 144 486" fill="none" stroke="rgb(0, 0, 0)" stroke-width="0.6" stroke-miterlimit="10" stroke-dasharray="1.7999999999999998 1.7999999999999998" pointer-events="stroke"/><path d="M 48 486 L 28.79 486" fill="none" stroke="rgb(0, 0, 0)" stroke-width="0.6" stroke-miterlimit="10" stroke-dasharray="1.7999999999999998 1.7999999999999998" pointer-events="stroke"/><path d="M 24.59 486 L 26.69 484.76 L 28.79 486 L 26.69 487.24 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-width="0.6" stroke-miterlimit="10" pointer-events="all"/><rect x="48" y="477" width="72" height="18" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" stroke-width="0.6" pointer-events="all"/><g transform="translate(-0.5 -0.5)scale(0.6)"><switch><foreignObject pointer-events="none" width="167%" height="167%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 810px; margin-left: 81px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">next-auth</div></div></div></foreignObject><text x="140" y="814" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">next-auth</text></switch></g><path d="M 456 462 L 558 462 L 576 480 L 576 510 L 456 510 L 456 462 Z" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" stroke-width="0.6" stroke-miterlimit="10" pointer-events="all"/><path d="M 558 462 L 558 480 L 576 480 Z" fill-opacity="0.05" fill="#000000" stroke="none" pointer-events="all"/><path d="M 558 462 L 558 480 L 576 480" fill="none" stroke="rgb(0, 0, 0)" stroke-width="0.6" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)scale(0.6)"><switch><foreignObject pointer-events="none" width="167%" height="167%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 198px; height: 1px; padding-top: 810px; margin-left: 761px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">OAuth providers page</div></div></div></foreignObject><text x="860" y="814" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">OAuth providers page</text></switch></g><rect x="144" y="522" width="204" height="72" fill="#e1d5e7" stroke="#9673a6" stroke-width="0.6" pointer-events="all"/><g transform="translate(-0.5 -0.5)scale(0.6)"><switch><foreignObject pointer-events="none" width="167%" height="167%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 338px; height: 1px; padding-top: 930px; margin-left: 242px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: left;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><span style="text-align: center; background-color: initial;"><div style="text-align: left;">   import { signIn } from "next-auth/react"</div><div style="text-align: left;"><br /></div><div style="text-align: left;">   signIn(provider, {</div><div style="text-align: left;">      callbackUrl: `/oauth?provider=${provider}&amp;expires=${</div><div style="text-align: left;">         expires ? "true" : "false"</div><div style="text-align: left;">         }${queryString ? "&amp;" : ""}${queryString}`</div><div style="text-align: left;">   });</div></span></div></div></div></foreignObject><text x="242" y="934" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px">import { signIn } from "next-auth/react"...</text></switch></g><path d="M 987.82 486 L 1050 486 L 1050 450" fill="none" stroke="rgb(0, 0, 0)" stroke-width="0.6" stroke-miterlimit="10" stroke-dasharray="1.7999999999999998 1.7999999999999998" pointer-events="stroke"/><path d="M 984.67 486 L 988.87 483.9 L 987.82 486 L 988.87 488.1 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-width="0.6" stroke-miterlimit="10" pointer-events="all"/><rect x="828" y="477" width="156" height="18" fill="#f8cecc" stroke="#b85450" stroke-width="0.6" pointer-events="all"/><g transform="translate(-0.5 -0.5)scale(0.6)"><switch><foreignObject pointer-events="none" width="167%" height="167%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 258px; height: 1px; padding-top: 810px; margin-left: 1381px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">await processService("oauth", { provider })</div></div></div></foreignObject><text x="1510" y="814" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">await processService("oauth", { provider })</text></switch></g><rect x="1002" y="276" width="96" height="186" fill="#e6e6e6" stroke="none" pointer-events="all"/><path d="M 1050 306 L 1050 432" fill="none" stroke="rgb(0, 0, 0)" stroke-width="0.6" stroke-miterlimit="10" stroke-dasharray="1.7999999999999998 1.7999999999999998" pointer-events="stroke"/><rect x="1014" y="288" width="72" height="18" fill="#d5e8d4" stroke="#82b366" stroke-width="0.6" pointer-events="all"/><g transform="translate(-0.5 -0.5)scale(0.6)"><switch><foreignObject pointer-events="none" width="167%" height="167%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 495px; margin-left: 1691px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">/api/eventbus</div></div></div></foreignObject><text x="1750" y="499" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">/api/eventbus</text></switch></g><rect x="1014" y="324" width="72" height="18" fill="#d5e8d4" stroke="#82b366" stroke-width="0.6" pointer-events="all"/><g transform="translate(-0.5 -0.5)scale(0.6)"><switch><foreignObject pointer-events="none" width="167%" height="167%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 555px; margin-left: 1691px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">verify jwt</div></div></div></foreignObject><text x="1750" y="559" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">verify jwt</text></switch></g><path d="M 1089.82 369 L 1118.18 369" fill="none" stroke="rgb(0, 0, 0)" stroke-width="0.6" stroke-miterlimit="10" stroke-dasharray="1.7999999999999998 1.7999999999999998" pointer-events="stroke"/><path d="M 1086.67 369 L 1090.87 366.9 L 1089.82 369 L 1090.87 371.1 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-width="0.6" stroke-miterlimit="10" pointer-events="all"/><path d="M 1121.33 369 L 1117.13 371.1 L 1118.18 369 L 1117.13 366.9 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-width="0.6" stroke-miterlimit="10" pointer-events="all"/><rect x="1014" y="360" width="72" height="18" fill="#d5e8d4" stroke="#82b366" stroke-width="0.6" pointer-events="all"/><g transform="translate(-0.5 -0.5)scale(0.6)"><switch><foreignObject pointer-events="none" width="167%" height="167%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 615px; margin-left: 1691px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">switch(service)</div></div></div></foreignObject><text x="1750" y="619" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">switch(service)</text></switch></g><rect x="1014" y="396" width="72" height="18" fill="#d5e8d4" stroke="#82b366" stroke-width="0.6" pointer-events="all"/><g transform="translate(-0.5 -0.5)scale(0.6)"><switch><foreignObject pointer-events="none" width="167%" height="167%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 675px; margin-left: 1691px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">save req results</div></div></div></foreignObject><text x="1750" y="679" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">save req results</text></switch></g><rect x="1014" y="432" width="72" height="18" fill="#d5e8d4" stroke="#82b366" stroke-width="0.6" pointer-events="all"/><g transform="translate(-0.5 -0.5)scale(0.6)"><switch><foreignObject pointer-events="none" width="167%" height="167%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 735px; margin-left: 1691px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">res.json({ ...data })</div></div></div></foreignObject><text x="1750" y="739" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">res.json({ ...data })</text></switch></g><path d="M 924 477 L 924 258 L 1050 258 L 1050 284.18" fill="none" stroke="rgb(0, 0, 0)" stroke-width="0.6" stroke-miterlimit="10" stroke-dasharray="1.7999999999999998 1.7999999999999998" pointer-events="stroke"/><path d="M 1050 287.33 L 1047.9 283.13 L 1050 284.18 L 1052.1 283.13 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-width="0.6" stroke-miterlimit="10" pointer-events="all"/><path d="M 1194 369 L 1218 369" fill="none" stroke="rgb(0, 0, 0)" stroke-width="0.6" stroke-miterlimit="10" stroke-dasharray="1.7999999999999998 1.7999999999999998" pointer-events="stroke"/><rect x="1122" y="360" width="72" height="18" fill="#dae8fc" stroke="#6c8ebf" stroke-width="0.6" pointer-events="all"/><g transform="translate(-0.5 -0.5)scale(0.6)"><switch><foreignObject pointer-events="none" width="167%" height="167%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 615px; margin-left: 1871px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">api/service/oauth</div></div></div></foreignObject><text x="1930" y="619" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">api/service/oauth</text></switch></g><path d="M 1218 355.8 C 1218 349.4 1278 349.4 1278 355.8 L 1278 382.2 C 1278 388.6 1218 388.6 1218 382.2 Z" fill="#dae8fc" stroke="#6c8ebf" stroke-width="0.6" stroke-miterlimit="10" pointer-events="all"/><path d="M 1218 355.8 C 1218 360.6 1278 360.6 1278 355.8 M 1218 358.2 C 1218 363 1278 363 1278 358.2 M 1218 360.6 C 1218 365.4 1278 365.4 1278 360.6" fill="none" stroke="#6c8ebf" stroke-width="0.6" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)scale(0.6)"><switch><foreignObject pointer-events="none" width="167%" height="167%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 98px; height: 1px; padding-top: 625px; margin-left: 2031px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">User model</div></div></div></foreignObject><text x="2080" y="629" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">User model</text></switch></g><rect x="1122" y="395.4" width="168" height="174.6" fill="#e1d5e7" stroke="#9673a6" stroke-width="0.6" pointer-events="all"/><g transform="translate(-0.5 -0.5)scale(0.6)"><switch><foreignObject pointer-events="none" width="167%" height="167%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 278px; height: 1px; padding-top: 805px; margin-left: 1872px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: left;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">   import { decode } from "next-auth/jwt"<br />   <br />   <span style="background-color: initial;">const decodedSessionToken = await decode({</span><div>     token: req.body.sessionToken,</div><div>     secret: process.env.NEXTAUTH_SECRET</div><div>   })</div><div><br /></div><div>  <span style="background-color: initial;"> <b>// check if providerEmail exists in database</b></span></div><div>   let user = await User.findOne({ </div><div>       providerEmail: decodedSessionToken.email</div><div>   });</div><div><br /></div><b>   // create new user if doesn't exist</b><div>   if (!user) {</div><div>      user = await User.create({</div><div>         authProvider: req.body.provider,</div><div>         providerEmail: decodedSessionToken.email</div><div>      })</div><div>    }</div></div></div></div></foreignObject><text x="1872" y="808" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px">import { decode } from "next-auth/jwt"...</text></switch></g><path d="M 348 486 L 368.18 486" fill="none" stroke="rgb(0, 0, 0)" stroke-width="0.6" stroke-miterlimit="10" stroke-dasharray="1.7999999999999998 1.7999999999999998" pointer-events="stroke"/><path d="M 371.33 486 L 367.13 488.1 L 368.18 486 L 367.13 483.9 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-width="0.6" stroke-miterlimit="10" pointer-events="all"/><rect x="288" y="477" width="60" height="18" fill="#dae8fc" stroke="#6c8ebf" stroke-width="0.6" pointer-events="all"/><g transform="translate(-0.5 -0.5)scale(0.6)"><switch><foreignObject pointer-events="none" width="167%" height="167%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 98px; height: 1px; padding-top: 810px; margin-left: 481px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">signIn( ... )</div></div></div></foreignObject><text x="530" y="814" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">signIn( ... )</text></switch></g><path d="M 432 486 L 452.18 486" fill="none" stroke="rgb(0, 0, 0)" stroke-width="0.6" stroke-miterlimit="10" stroke-dasharray="1.7999999999999998 1.7999999999999998" pointer-events="stroke"/><path d="M 455.33 486 L 451.13 488.1 L 452.18 486 L 451.13 483.9 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-width="0.6" stroke-miterlimit="10" pointer-events="all"/><rect x="372" y="477" width="60" height="18" fill="#f8cecc" stroke="#b85450" stroke-width="0.6" pointer-events="all"/><g transform="translate(-0.5 -0.5)scale(0.6)"><switch><foreignObject pointer-events="none" width="167%" height="167%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 98px; height: 1px; padding-top: 810px; margin-left: 621px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">redirect</div></div></div></foreignObject><text x="670" y="814" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">redirect</text></switch></g><path d="M 596.18 486 L 576 486" fill="none" stroke="rgb(0, 0, 0)" stroke-width="0.6" stroke-miterlimit="10" stroke-dasharray="1.7999999999999998 1.7999999999999998" pointer-events="stroke"/><path d="M 599.33 486 L 595.13 488.1 L 596.18 486 L 595.13 483.9 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-width="0.6" stroke-miterlimit="10" pointer-events="all"/><path d="M 660 486 L 680.18 486" fill="none" stroke="rgb(0, 0, 0)" stroke-width="0.6" stroke-miterlimit="10" stroke-dasharray="1.7999999999999998 1.7999999999999998" pointer-events="stroke"/><path d="M 683.33 486 L 679.13 488.1 L 680.18 486 L 679.13 483.9 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-width="0.6" stroke-miterlimit="10" pointer-events="all"/><rect x="600" y="477" width="60" height="18" fill="#f8cecc" stroke="#b85450" stroke-width="0.6" pointer-events="all"/><g transform="translate(-0.5 -0.5)scale(0.6)"><switch><foreignObject pointer-events="none" width="167%" height="167%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 98px; height: 1px; padding-top: 810px; margin-left: 1001px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">redirect</div></div></div></foreignObject><text x="1050" y="814" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">redirect</text></switch></g><path d="M 804 486 L 828 486" fill="none" stroke="rgb(0, 0, 0)" stroke-width="0.6" stroke-miterlimit="10" stroke-dasharray="1.7999999999999998 1.7999999999999998" pointer-events="stroke"/><rect x="684" y="468" width="120" height="36" fill="#fff2cc" stroke="#d6b656" stroke-width="0.6" pointer-events="all"/><g transform="translate(-0.5 -0.5)scale(0.6)"><switch><foreignObject pointer-events="none" width="167%" height="167%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 198px; height: 1px; padding-top: 810px; margin-left: 1141px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">/oauth?path=/route&amp;param1=...</div></div></div></foreignObject><text x="1240" y="814" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">/oauth?path=/route&amp;param1=...</text></switch></g><rect x="684" y="522" width="156" height="72" fill="#e1d5e7" stroke="#9673a6" stroke-width="0.6" pointer-events="all"/><g transform="translate(-0.5 -0.5)scale(0.6)"><switch><foreignObject pointer-events="none" width="167%" height="167%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 258px; height: 1px; padding-top: 930px; margin-left: 1142px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: left;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><span style="text-align: center; background-color: initial;"><div style="text-align: left;">   import { useSession } from "next-auth/react"</div><div style="text-align: left;"><br /></div><div style="text-align: left;">   const { data: session } = useSession()</div><div style="text-align: left;"><br /></div><div style="text-align: left;">   if (useSession) login()</div><div style="text-align: left;">   else logout()</div></span></div></div></div></foreignObject><text x="1142" y="934" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px">import { useSession } from "next-auth/re...</text></switch></g><rect x="684" y="300" width="222" height="150" fill="#e1d5e7" stroke="#9673a6" stroke-width="0.6" pointer-events="all"/><g transform="translate(-0.5 -0.5)scale(0.6)"><switch><foreignObject pointer-events="none" width="167%" height="167%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 368px; height: 1px; padding-top: 625px; margin-left: 1142px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: left;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">   setLoading(true)<br /><br />   const res = <span style="text-align: center;">await processService("oauth", {<br />      provider: query.provider<br />   })<br /><br />   const { user, token, success, error } = res<br /></span><span style="text-align: center; background-color: initial;"><br />   Cookie.set("token", token, {<br /></span><span style="text-align: center; background-color: initial;">      expires: expires ? undefined : 3600<br /></span><span style="text-align: center; background-color: initial;">   });<br /></span><span style="text-align: center; background-color: initial;"><br />   setUser(user);<br /><br />   await router.push(`${path}${queryString ? "?" : ""}${queryString}`)<br /></span></div></div></div></foreignObject><text x="1142" y="629" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px">setLoading(true)...</text></switch></g><rect x="894" y="24" width="204" height="221.4" fill="#dae8fc" stroke="#6c8ebf" stroke-width="0.6" pointer-events="all"/><g transform="translate(-0.5 -0.5)scale(0.6)"><switch><foreignObject pointer-events="none" width="167%" height="167%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 338px; height: 1px; padding-top: 225px; margin-left: 1492px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: left;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">   try {<br />      switch (req.body.service) {<br />         <span style="background-color: initial;">case "oauth":</span><div>             req = await axios.post("/api/services/oauth", {</div><div>                ...body,</div><div>                sessionToken:</div><div>                   cookies["next-auth.session-token"] ||</div><div>                   cookies["__Secure-next-auth.session-token"],</div><div>              })</div><div>           break</div><div><br /></div><div><div>         default:</div><div>            req.data = { <span style="background-color: initial;">error: "Invalid Service", </span><span style="background-color: initial;">success: false </span><span style="background-color: initial;">}</span></div><div>            break</div></div>      }<br /><br />      res.status(200).json({ ...req.data })<br /><br />   } catch(error) {<br />      res.status(500).json({ success: false, error })<br />   }</div></div></div></foreignObject><text x="1492" y="228" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px">try {...</text></switch></g></g><switch><g requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"/><a transform="translate(0,-5)" xlink:href="https://www.diagrams.net/doc/faq/svg-export-text-problems" target="_blank"><text text-anchor="middle" font-size="10px" x="50%" y="100%">Text is not SVG - cannot display</text></a></switch></svg>